(this["webpackJsonpkerfuffle-web"]=this["webpackJsonpkerfuffle-web"]||[]).push([[0],{115:function(e,t,c){},132:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c.n(n),s=c(11),i=c.n(s),r=(c(81),c.p,c(82),c(83),c(84),c(85),c(86),c(21)),l=c(9),o=c(3),j=c(27),b=(c(87),c(12)),d=c(62),p=c(13),u=c(16),h=c.n(u),O=c(48),x=c(31),f=c(32),m=c.n(f),v=function e(){for(var t={get:function(t,c){return Object.keys(t).includes(c)?t[c]:"$"===c[0]?function(n){return e.apply(void 0,Object(O.a)(t.paths).concat([c.substr(1),n]))}:e.apply(void 0,Object(O.a)(t.paths).concat([c]))}},c=arguments.length,n=new Array(c),a=0;a<c;a++)n[a]=arguments[a];var s={paths:n,toString:function(){return this.paths.join("/")},param:function(e){return this.paths.push(e),this}};return new Proxy(s,t)}("localhost:3000"===window.location.host?"http://localhost:8080":window.location.origin).api.v1;function g(){return(g=Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get(v.application);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(x.a)(h.a.mark((function e(t){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get(v.$application(t));case 2:return c=e.sent,e.abrupt("return",c.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=Object(x.a)(h.a.mark((function e(t){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Posting",v.application,t),e.next=3,m.a.post(v.application,t);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(x.a)(h.a.mark((function e(t){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.patch(v.$application(t).hold);case 2:return c=e.sent,e.abrupt("return",c.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=c(35),S=c(63),T=(c(115),c(24)),I=c(25),B=c(47),F=c(30),P=c(73),R=c(74),C=c(1),M=function(e){var t=e.object;return Object(C.jsx)("div",{style:{fontFamily:"'IBM Plex Mono'",fontSize:"0.8em"},children:Object(C.jsx)(B.a,{text:JSON.stringify(t,null,2),language:"json",showLineNumbers:!1,theme:B.b})})},_=function(e){var t=e.header,c=e.data;return Object(C.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(C.jsx)("h4",{children:t}),Object(C.jsx)("p",{children:Object(C.jsx)("code",{children:c})})]})},L=function(e){var t=e.height;return Object(C.jsx)("div",{style:{height:t||"1em"}})};function A(e){var t=e.app;return Object(C.jsx)("div",{children:Object(C.jsx)(M,{object:t.cfs})})}function D(e){var t=e.app;return Object(C.jsx)("div",{children:Object(C.jsx)(M,{object:t.proxies})})}function U(e){var t=e.app;return Object(C.jsx)("div",{children:Object.values(t.provisions).map((function(e){return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(L,{height:"1em"}),Object(C.jsx)(I.Panel,{header:e.id.toString().toUpperCase(),children:Object(C.jsx)(M,{object:e})})]})}))})}function z(e){var t=e.app,c=e.reload,a=Object(n.useRef)(null),s=function(){(function(e){return k.apply(this,arguments)})(t.application.id).then((function(e){a.current.show({severity:"info",summary:"Success",detail:"Toggled maintenance mode",life:3e3}),c&&c()})).catch((function(e){a.current.show({severity:"error",summary:"Failed",detail:"Failed to toggle maintenance mode",life:3e3})}))},i=t.application.status_log&&t.application.status_log[t.application.status_log.length-1];return Object(C.jsxs)("div",{className:"p-grid",children:[Object(C.jsxs)("div",{className:"p-col-8",children:[Object(C.jsx)(R.Toast,{ref:a}),Object(C.jsx)(I.Panel,{header:"Information",children:Object(C.jsxs)("div",{className:"p-field p-fluid",children:[Object(C.jsx)("label",{className:"p-d-block",children:Object(C.jsx)("b",{children:"ID"})}),Object(C.jsx)(p.InputText,{value:t.application.id,disabled:!0,className:"p-d-block"}),Object(C.jsx)(L,{height:"0.8em"}),Object(C.jsx)("label",{className:"p-d-block",children:Object(C.jsx)("b",{children:"Repository"})}),Object(C.jsx)(p.InputText,{value:t.application.install_configuration.repository,disabled:!0,className:"p-d-block"}),Object(C.jsx)(L,{height:"0.8em"}),Object(C.jsx)("label",{className:"p-d-block",children:Object(C.jsx)("b",{children:"Branch"})}),Object(C.jsx)(p.InputText,{value:t.application.install_configuration.branch,disabled:!0,className:"p-d-block"}),Object(C.jsx)(L,{height:"0.8em"}),Object(C.jsx)("label",{className:"p-d-block",children:Object(C.jsx)("b",{children:"Bootstrap"})}),Object(C.jsx)(p.InputText,{value:t.application.install_configuration.bootstrap,disabled:!0,className:"p-d-block"}),Object(C.jsx)(L,{height:"0.8em"}),Object(C.jsx)("label",{className:"p-d-block",children:Object(C.jsx)("b",{children:"Meta.name"})}),Object(C.jsx)(p.InputText,{value:t.application.meta.name,disabled:!0,className:"p-d-block"})]})}),Object(C.jsx)(L,{}),Object(C.jsx)(I.Panel,{header:"Provision Status",children:Object(C.jsx)(M,{object:t.processes})})]}),Object(C.jsxs)("div",{className:"p-col-4",children:[i&&"running"===i.flag&&Object(C.jsxs)("div",{className:"p-fluid",children:[Object(C.jsx)(F.Message,{severity:{booting:"warn",running:"info",failed:"error",crashed:"error",unknown:""}[i.flag],text:i.reason}),Object(C.jsx)(L,{})]}),t.application.maintenance_mode&&Object(C.jsxs)("div",{className:"p-fluid",children:[Object(C.jsx)(F.Message,{severity:"warn",text:"This application is in maintenance mode"}),Object(C.jsx)(L,{})]}),Object(C.jsxs)(I.Panel,{header:"Actions",children:[Object(C.jsx)(b.Button,{label:"Reload",className:"p-button-outlined"}),Object(C.jsx)(b.Button,{label:"Shutdown",className:"p-button-outlined p-button-help"}),Object(C.jsx)(b.Button,{label:"Delete",className:"p-button-outlined p-button-danger"}),Object(C.jsx)(P.Divider,{align:"left",children:Object(C.jsx)("b",{children:"Maintenance Mode"})}),t.application.maintenance_mode?Object(C.jsx)(b.Button,{label:"Go Live",onClick:s,className:"p-button-outlined p-button-success"}):Object(C.jsx)(b.Button,{label:"Hold Application",onClick:s,className:"p-button-outlined p-button-warning"})]}),Object(C.jsx)(L,{}),Object(C.jsx)(I.Panel,{header:"Last Commit",children:Object(C.jsx)("div",{style:{whiteSpace:"pre-line",fontFamily:"'IBM Plex mono'",fontSize:"0.8em"},children:t.last_commit})})]})]})}var E=function(){var e=Object(o.f)().appId,t=Object(n.useState)(),c=Object(l.a)(t,2),a=c[0],s=c[1],i=Object(n.useState)(!1),r=Object(l.a)(i,2),j=r[0],b=r[1],d=Object(n.useState)(),p=Object(l.a)(d,2),u=p[0],h=p[1],O=Object(n.useRef)(null),x=Object(n.useState)([{label:"Loading..."}]),f=Object(l.a)(x,2),m=f[0],v=f[1];Object(n.useEffect)((function(){b(!0),function(e){return N.apply(this,arguments)}(e).then((function(e){s(e),v([{label:e.application.id}])})).catch((function(e){O.current.show({severity:"error",sticky:!0,content:Object(C.jsx)(_,{header:"Failed to load",data:e.response.data.error})})})).finally((function(){return b(!1)}))}),[e,u]);return Object(C.jsxs)("div",{className:"app-view-panel",children:[Object(C.jsx)(S.BreadCrumb,{model:m,home:{icon:"pi pi-cog",url:"/console"}}),Object(C.jsx)("div",{className:"p-field p-fluid",children:Object(C.jsx)(w.Messages,{ref:O})}),j&&Object(C.jsx)("div",{className:"p-field pi-fluid fl-center",children:Object(C.jsx)("i",{className:"pi pi-spin pi-spinner",style:{fontSize:"2em"}})}),a&&Object(C.jsxs)(T.TabView,{children:[Object(C.jsx)(T.TabPanel,{header:"Overview",children:Object(C.jsx)(z,{app:a,reload:function(){h(Math.random())}})}),Object(C.jsx)(T.TabPanel,{header:"Provisions",children:Object(C.jsx)(U,{app:a})}),Object(C.jsx)(T.TabPanel,{header:"Reverse Proxies",children:Object(C.jsx)(D,{app:a})}),Object(C.jsx)(T.TabPanel,{header:"Cloudflare",children:Object(C.jsx)(A,{app:a})})]})]})},J=(c(129),c(46)),$=function(){return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("div",{className:"header",children:Object(C.jsx)("span",{className:"logotype",children:"\\kerfuffle\\"})}),Object(C.jsx)("div",{className:"p-d-flex p-jc-center",children:Object(C.jsxs)(o.c,{children:[Object(C.jsx)(o.a,{path:"/application/:appId",children:Object(C.jsx)(E,{})}),Object(C.jsx)(o.a,{path:"/",children:Object(C.jsx)(H,{})})]})})]})},H=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),c=t[0],a=t[1],s=Object(n.useState)([]),i=Object(l.a)(s,2),o=i[0],j=i[1],u=Object(n.useState)(),h=Object(l.a)(u,2),O=(h[0],h[1]),x=Object(n.useState)(!1),f=Object(l.a)(x,2),m=f[0],v=f[1],N=Object(n.useState)({repository:"",branch:"master",boostrap:".kerfuffle"}),k=Object(l.a)(N,2),S=k[0],T=k[1],I=Object(n.useState)(),B=Object(l.a)(I,2),P=B[0],R=B[1],M=Object(n.useState)(!1),_=Object(l.a)(M,2),L=_[0],A=_[1],D=Object(n.useRef)(null);Object(n.useEffect)((function(){(function(){return g.apply(this,arguments)})().then((function(e){e?(j(e),v(!1)):v(!0)})).catch((function(e){return O(e)}))}),[P]);var U,z=function(){A(!0),function(e){return y.apply(this,arguments)}(S).then((function(e){a(!1),R(Math.random())})).catch((function(e){console.debug(e.response),D.current.show({severity:"error",sticky:!0,content:Object(C.jsxs)("div",{className:"error-message",children:[Object(C.jsx)("h4",{children:"Failed to deploy"}),Object(C.jsx)("code",{children:e.response.data.error})]})})})).finally((function(){A(!1)}))};return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)("div",{className:"application-view",children:[Object(C.jsx)("div",{className:"actions",children:Object(C.jsx)(b.Button,{label:"Add Repository",className:"p-button-outlined p-button-help",onClick:function(){return a(!0)}})}),m&&Object(C.jsx)("div",{className:"responsive p-field p-fluid",children:Object(C.jsx)(F.Message,{severity:"info",text:"There's no applications. Click on Add Repository to add one."})}),o.map((function(e){return Object(C.jsx)(q,{application:e})}))]}),Object(C.jsxs)(d.Dialog,{header:"Add New Repository",visible:c,className:"responsive",footer:(U=function(){return a(!1)},Object(C.jsxs)("div",{children:[Object(C.jsx)(b.Button,{label:"Cancel",icon:"pi pi-times",onClick:U,className:"p-button-text"}),Object(C.jsx)(b.Button,{label:L?"Installing...":"Add Repository",icon:"pi pi-check",onClick:z,autoFocus:!0,disabled:L})]})),onHide:function(){return a(!1)},children:[Object(C.jsxs)("div",{className:"p-field p-fluid",children:[Object(C.jsxs)("label",{htmlFor:"repoURL",className:"p-d-block",children:["Repository URL ",Object(C.jsx)("code",{children:"*required"})]}),Object(C.jsx)(p.InputText,{value:S.repository,onInput:function(e){return T(Object(r.a)(Object(r.a)({},S),{},{repository:e.target.value}))},id:"repoURL","aria-describedby":"username1-help",className:"p-d-block"}),Object(C.jsx)("small",{id:"repoURL-help",className:"p-d-block",children:"URL to clone"})]}),Object(C.jsxs)("div",{className:"p-field p-fluid",children:[Object(C.jsx)("label",{htmlFor:"branch",className:"p-d-block",children:"Branch"}),Object(C.jsx)(p.InputText,{value:S.branch,onInput:function(e){return T(Object(r.a)(Object(r.a)({},S),{},{branch:e.target.value}))},id:"branch","aria-describedby":"username1-help",className:"p-d-block"}),Object(C.jsxs)("small",{id:"branch-help",className:"p-d-block",children:["Branch to checkout after cloning, leave empty to use ",Object(C.jsx)("code",{children:"master"})]})]}),Object(C.jsxs)("div",{className:"p-field p-fluid",children:[Object(C.jsx)("label",{htmlFor:"bootstrap",className:"p-d-block",children:"Kerfuffle Bootstrap File"}),Object(C.jsx)(p.InputText,{value:S.boostrap,onInput:function(e){return T(Object(r.a)(Object(r.a)({},S),{},{bootstrap:e.target.value}))},id:"bootstrap","aria-describedby":"username1-help",className:"p-d-block"}),Object(C.jsxs)("small",{id:"bootstrap-help",className:"p-d-block",children:["Bootstrap file to use, leave empty to use ",Object(C.jsx)("code",{children:".kerfuffle"})]})]}),Object(C.jsx)("div",{className:"p-field p-fluid",children:Object(C.jsx)(w.Messages,{ref:D})})]})]})},q=function(e){var t=e.application,c=t.status_log&&t.status_log[t.status_log.length-1],n="running"!==c.flag;return Object(C.jsx)(j.b,{to:"/application/".concat(t.id),children:Object(C.jsxs)("div",{className:"item",children:[Object(C.jsxs)("div",{className:"left-info",children:[Object(C.jsx)("i",{className:"pi pi-clone icon"}),"running"===c.flag&&Object(C.jsx)(J.Tag,{className:"p-mr-2",value:"Running"}),"running"!==c.flag&&Object(C.jsx)(J.Tag,{className:"p-mr-2",value:c.flag}),Object(C.jsx)("span",{children:t.meta.name||t.id}),n&&Object(C.jsx)("i",{className:"pi pi-exclamation-circle icon-error"})]}),Object(C.jsxs)("div",{className:"right-info",children:[Object(C.jsx)("i",{className:"pi pi-link icon-1"}),Object(C.jsxs)("span",{children:[t.install_configuration.repository," \u2022\xa0"]}),Object(C.jsxs)("span",{children:[t.install_configuration.branch,"\xa0"]})]})]})})};var G=function(){return Object(C.jsx)(j.a,{children:Object(C.jsx)("div",{className:"App",children:Object(C.jsx)($,{})})})},K=function(e){e&&e instanceof Function&&c.e(155).then(c.bind(null,318)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;c(e),n(e),a(e),s(e),i(e)}))};i.a.render(Object(C.jsx)(a.a.StrictMode,{children:Object(C.jsx)(G,{})}),document.getElementById("root")),K()},81:function(e,t,c){},82:function(e,t,c){},87:function(e,t,c){}},[[132,152,153]]]);
//# sourceMappingURL=main.ef785d54.chunk.js.map